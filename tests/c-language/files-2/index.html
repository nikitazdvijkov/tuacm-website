<!doctype html>
<html lang="en-US">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<link rel="icon" type="image/x-icon" href="https://tuacm.com/resources/favicon.png">
		<link rel="stylesheet" href="https://tuacm.com/css/nanobs.css">
		<link rel="stylesheet" href="https://tuacm.com/css/general.css">
		<link rel="stylesheet" href="https://tuacm.com/css/article.css">
		<link rel="stylesheet" href="https://tuacm.com/css/code-style/trac+dark.css">
		<link rel="stylesheet" href="https://tuacm.com/css/code-block.css">
		<link rel="stylesheet" href="https://tuacm.com/css/terminal.css">
		<link rel="stylesheet" href="https://tuacm.com/css/aside.css">
		<style>
			blockquote {
				padding-left: 1ch;
				border-left: 3px solid #B0B0B0;
				background: #E0E0E0;
			}
			.aside blockquote {
				background: #F0F0F0;
			}
			.spoiler {
			    border: 3px solid #B0B0B0;
			    padding: 1em;
			    border-radius: 8px;
			    background: #E6E6FA;
			    margin-bottom: 1em;
			}
			.spoiler .code-block {
			    opacity: 0;
			    margin-bottom: 0;
			}
			.spoiler .code-block:hover {
			    opacity: 1;
			}
		</style>
		<link rel="stylesheet" href="https://tuacm.com/css/author-description.css">
		<title>Files in C, Pt. 2</title>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146716017-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-146716017-1');
		</script>
	</head>
	<body id="body-handle">
		<div id="webpage-header" class="text-center py-5 mb-5 bg-yellow" style="background: black;">
			<img src="https://tuacm.com/resources/tuacm-logo.svg?sanitize=True" alt="TU ACM logo." style="width: calc(30% + 150px);">
			<div>
				<a href="https://tuacm.com/blog" class="font-weight-bolder" style="color: #DC144C; font-size: calc(1.5em + 1vw);">blog</a>
			</div>
		</div>
		<div>
			<div class="article">
				<div id="article-title"><h1 id="files-in-c-pt-2">Files in C, Pt. 2</h1></div>
				<div id="meta-description">Now that we can open files in our program, let's interact with them.</div>
				<div id="date-and-tags">Posted 1 October 2019 at 11:33 AM </div>
				<div id="author-box">
					<div id="author-image" style="background: url(https://tuacm.com/authors/joseph-mellor/large.jpg) 50% 50% no-repeat; background-size: auto 50px;"></div>
					<div id="author-name">By Joseph Mellor</div>
				</div>
				<hr style="border: 3px solid black;">
				<p><i>This is the fifteenth article in the </i>Making Sense of C<i> series.
					In this article, we're going to finish our discussion of basic file interaction
					by introducing a way to print things out to the terminal and to read a file word
					by word using format strings.</i>
				</p>
				<div class="aside" >
					<h5>Review of Special Characters</h5>
					<hr>
					<p>I suggest you go back to the article on <a
						href="../strings/index.html#escape-characters">Strings in C and look at the
						escape characters section</a> because we're going to use them in this article.
					</p>
				</div>
				<h2 id="io-without-format-strings">I/O Without Format Strings</h2>
				<p>As you can imagine, at this point we can easily introduce the functionality to
					do things like "read a line from a file" and "print characters out to a file".
					For reading a line from a file, we just need to come up with a function that
					takes in the <code>FILE *</code> of the file we want to read, some output buffer to
					store it, and <b>the number of characters we want to read (since we need to
					make sure that we can actually hold the file in memory)</b>.
					It might also be useful to return a <code>char *</code> that points to the output buffer if
					it works, and <code>NULL</code> if it doesn't.
					Likewise, printing characters out to a file requires us to specify the buffer we
					want to print to the file and the <code>FILE *</code> of the file we want to write to.
				</p>
				<h3 id="fgets-and-fputs"><code>fgets</code> and <code>fputs</code></h3>
				<p>These functions also exist in the standard library, and they're known as <code>fgets</code>
					(<code>f</code>ile <code>get</code> <code>s</code>tring) and <code>fputs</code> (<code>f</code>ile <code>put</code> <code>s</code>tring).
					They have the syntax
				</p>
<div class="code-block"><pre><span></span><span class="kt">char</span> <span class="o">*</span> <span class="nf">fgets</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span> <span class="n">file_reader</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">fputs</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">str</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span> <span class="n">file_writer</span><span class="p">);</span>
</pre></div>
				
				<p><code>fputs</code> returns an <code>int</code>, but different implementations do different things.
					In all implementations, returning a non-negative number means that your program
					successfully wrote to the file.
					If it can't write to the file, then <code>fputs</code> will return a constant known as
					<code>EOF</code> for (<code>E</code>nd <code>O</code>f <code>F</code>ile), which you can test for in an <code>if</code> statement.
				</p>
				<p>An example usage of a simple program that copies up to 1024 characters from the
					first line of a file to the end of another would look like
				</p>
				<div class="code-blocktable">
<table><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="code-block"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">copy_first_line</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="n">source</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span> <span class="n">dest</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">3</span> <span class="o">&gt;</span> <span class="n">argc</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">char</span> <span class="o">*</span> <span class="n">source_file_name</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kt">char</span> <span class="o">*</span> <span class="n">dest_file_name</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

    <span class="kt">FILE</span> <span class="o">*</span> <span class="n">source</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">source_file_name</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">);</span>
    <span class="kt">FILE</span> <span class="o">*</span> <span class="n">dest</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">dest_file_name</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">errno</span> <span class="o">=</span> <span class="n">copy_first_line</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">dest</span><span class="p">);</span>

    <span class="n">fclose</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
    <span class="n">fclose</span><span class="p">(</span><span class="n">dest</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">errno</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">copy_first_line</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="n">source</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span> <span class="n">dest</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">==</span> <span class="n">source</span> <span class="o">||</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">dest</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">buff_sz</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">buff_sz</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">==</span> <span class="n">fgets</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">buff_sz</span><span class="p">,</span> <span class="n">source</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">EOF</span> <span class="o">==</span> <span class="n">fputs</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">dest</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>				
				</div>
				<p>I put the code for actually copying from one file to the other file in its own
					function so that I don't have to close the files if I get an error in opening,
					reading, or writing to a file.
					I could probably make the code above a little cleaner by moving the code from
					lines <code>13</code> to <code>19</code> into their own function and returning <code>errno</code> from the new
					function, but it would be diminishing returns.
					At least to me, <code>main</code> should handle getting user input from the command line
					and calling the functions that drive the program and nothing else, though you
					can make a lot of exceptions.
				</p>
				<p>Since we haven't yet covered how we can implement error messages, I just close
					the files and exit the program with a <code>-1</code> to indicate something going wrong.
					Later, we can use the return value from <code>main</code> to figure out what went wrong.
					There are some specific error numbers reserved in <code>C</code> that we can use in the
					standard library, but we aren't going to worry about them for now.
				</p>
				<h3 id="the-terminal-as-a-file">The Terminal as a File</h3>
				<p>In Unix (and later Linux and Mac OS), <b>everything is a file (descriptor)</b>,
					though most people leave off the (descriptor) part.
					In particular, this means that things like printers, the terminal, network
					connections, etc. can be represented with <code>FILE *</code> objects.
					Up to this point, I've been using names like <code>file_reader</code> and <code>file_writer</code> for
					the <code>FILE *</code> parameters in the standard library functions, but the <a
					href="https://en.cppreference.com/w/c/io/fputs">documentation for C</a> uses the
					more general parameter name of <code>stream</code>
				</p>
<div class="code-block"><pre><span></span><span class="kt">char</span> <span class="o">*</span> <span class="nf">fgets</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span> <span class="n">stream</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">fputs</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">str</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span> <span class="n">stream</span><span class="p">);</span>
</pre></div>
				
				<p>since you could be taking in a file as an input or a network connection or
					anything else (there are better functions to use than these, though).
					Since the terminal is also a <code>FILE *</code> object, we should be able to pass it into
					our file manipulation functions.
					In <code>C</code>, we have three preexisting <code>FILE *</code> objects:
				</p>
				<ul>
					<li><code>stdout</code> for printing stuff to the terminal,
					</li>
					<li><code>stderr</code> for printing errors out to the terminal,
					</li>
					<li>and <code>stdin</code> for getting user input from the terminal.
					</li>
				</ul>
				<p>You don't need to open or close them since the operating system itself will take
					care of them for you.
				</p>
				<p>As an example, I modified the <code>main</code> function so that it prompts you for the
					text that you want to add to the file:
				</p>
				<div class="code-blocktable">
<table><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="code-block"><pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">    <span class="k">if</span> <span class="p">(</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="n">argc</span><span class="p">)</span> <span class="p">{</span>
</span>        <span class="c1">// \n is the newline character</span>
<span class="hll">        <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;Not enough arguments provided.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
</span>        <span class="c1">// \t is a tab character</span>
<span class="hll">        <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;usage:</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">)</span><span class="o">:</span>
</span><span class="hll">        <span class="n">fputs</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stderr</span><span class="p">);</span>
</span><span class="hll">        <span class="n">fputs</span><span class="p">(</span><span class="s">&quot; output_file</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
</span>        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">char</span> <span class="o">*</span> <span class="n">dest_file_name</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kt">FILE</span> <span class="o">*</span> <span class="n">dest</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">dest_file_name</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">);</span>

    <span class="c1">// \&quot; is the double quote character and we need to use it because just</span>
    <span class="c1">// a &quot; would end the string.</span>
<span class="hll">    <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;What line do you want to add to </span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
</span><span class="hll">    <span class="n">fputs</span><span class="p">(</span><span class="n">dest_file_name</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
</span><span class="hll">    <span class="n">fputs</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
</span><span class="hll">    <span class="kt">int</span> <span class="n">errno</span> <span class="o">=</span> <span class="n">copy_first_line</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="n">dest</span><span class="p">);</span>
</span>
    <span class="n">fclose</span><span class="p">(</span><span class="n">dest</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">errno</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>				
				</div>
				<p>First, now that I can print things out to the terminal (specifically <code>stderr</code>),
					I added a few lines above to tell the user that he or she provided too few
					arguments to the program and print out the proper usage (printing out the usage
					is standard if the command line input isn't formatted correctly).
					Also, since we only expect to have two arguments (the name of the program and
					the file we're adding to), we changed the first highlighted line to check if
					there are at least two arguments.
					We're no longer using a <code>source</code> file, I just removed all the lines involving
					it.
					I also replaced <code>source</code> with <code>stdin</code> in the call to <code>copy_first_line</code>.
					Then, I added a few lines to print out a line to <code>stdout</code> asking the user what
					line he or she wanted to add to the file.
				</p>
				<div class="aside" >
					<h5><code>stdin</code></h5>
					<hr>
					<p>Using <code>stdin</code> will pause your program and allow the user to type something into
						the terminal.
						The program will remain paused until the user hits <code>Enter</code>.
						Until then, it's just like typing something into a form or a login screen where
						you can hit backspace to remove characters.
						In IDEs that close the terminal window immediately after the program finishes,
						some users will add a read from <code>stdin</code> to pause the program so they can see the
						output.
					</p>
				</div>
				<h2 id="io-with-format-strings">I/O With Format Strings</h2>
				<p>If you look back at the example program, you'll notice that I had to break one
					line in the output into multiple calls to <code>fputs</code> because I needed to tell it to
					print out everything before the name of the file, then the name of the file,
					then everything after the name of the file.
					It would be nice to be able to write one line of code to print out the message,
					so we're going to invent something called a <b>format string</b>.
				</p>
				<p>A <b>format string</b> is a sequence of <code>char</code>s (just like a regular string)
					that the computer will read as instructions on what to print out.
					For example, we want to print out "What line do you want to add to
					"<code>dest_file_name</code>"?".
				</p>
				<h3 id="escape-sequences-in-format-strings">Escape Sequences in Format Strings</h3>
				<p>We should be able to have something like an escape character in our format
					strings that tells the computer to stop printing out the characters in the
					string, get something different to print out, then continue printing out the
					rest of the characters in the string.
					We've already reserved the <code>'\'</code> character for the normal escape character for
					things like newlines and tabs, so we need something else.
					For <code>C</code>, Ritchie decided to use the <code>%</code> sign again, probably because it has only
					been used up to this point for the remainder operation and everything else on a
					keyboard (letters, numbers, punctuation, etc.) is already in use.
				</p>
				<p>In our case, we want to tell the program to print out the normal series of
					characters, then print out a different string, then print out the rest of the
					characters.
					Since we're printing out a string, let's use <code>%s</code> to tell the computer to print
					out a string.
					Our format string should then use
				</p>
<div class="code-block"><pre><span></span><span class="s">&quot;What line do you want to add to </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">?&quot;</span>
</pre></div>
				
				<p>We'll also need to tell the computer which information to print out.
				</p>
				<h3 id="printf-and-fprintf"><code>printf</code> and <code>fprintf</code></h3>
				<p>We'll make a new function called <code>printf</code> (<code>print</code> <code>f</code>ormat string)
				</p>
<div class="code-block"><pre><span></span><span class="kt">int</span> <span class="nf">printf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format_string</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
				
				<p>which will print data out to the terminal.
				</p>
				<div class="aside" >
					<h5>Variadic Functions</h5>
					<hr>
					<p><b>Variadic Functions</b> are functions that can have a variable number of
						arguments.
						You can say that the first few arguments needs to have a specific format, such
						as in <code>printf</code> having a <code>const char * format_string</code> as its first argument, then
						say the rest of the arguments can be whatever.
						In our case, whenever <code>printf</code> hits one of our escape sequences (<code>%s</code>), it needs
						to know what it should print out.
						After the <code>format_string</code> argument, the rest of the arguments are what it should
						print out in order.
						For example:
					</p>
<div class="code-block"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s %s %s %s.&quot;</span><span class="p">,</span> <span class="s">&quot;This&quot;</span><span class="p">,</span> <span class="s">&quot;is&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;test&quot;</span><span class="p">);</span>
</pre></div>
					
					<p>will print out
					</p>
					<div class="terminal"><pre>
This is a test.
</pre>
					</div>
					<p>As a more realisitic example, let's say that we want to print out a word and how
						many times it shows up in a text file.
						In this case, for each word, we would want to print out the word, a space or a
						colon, and then the number of times it shows up in the text.
						Using a format string and assuming that <code>word</code> is a <code>char *</code> and <code>count</code> is an
						<code>unsigned int</code> (we can't have a negative count), we can use
					</p>
<div class="code-block"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s: %u</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">);</span>    <span class="c1">// %u is for an unsigned int</span>
</pre></div>
					
					<p>which tells the computer to print <code>word</code>, then a colon, then a space, then print
						<code>count</code>, then print a newline.
					</p>
				</div>
				<p>In our example program, we can replace our three <code>fputs</code> lines with
				</p>
<div class="code-block"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;What line do you want to add to </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dest_file_name</span><span class="p">);</span>
</pre></div>
				
				<p>If, instead, we want to print to a file, we can use <code>fprintf</code>, which has the
					syntax
				</p>
<div class="code-block"><pre><span></span><span class="kt">int</span> <span class="nf">fprintf</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="n">stream</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
				
				<p>where the only difference between <code>fprintf</code> and <code>printf</code> is that you have to
					specify the <code>FILE *</code> first for <code>fprintf</code> while <code>printf</code> prints to <code>stdout</code>.
					You could replace every <code>printf</code> in your program with an <code>fprintf</code> with its
					first argument being <code>stdout</code> and see no difference in your program.
					For example, we could have written our <code>printf</code> above using <code>fprintf</code> using
				</p>
<div class="code-block"><pre><span></span><span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;What line do you want to add to </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dest_file_name</span><span class="p">);</span>
</pre></div>
				
				<p>Later, we'll extend the format strings to include things like restricting the
					number of characters we read.
				</p>
				<h2 id="general-naming-conventions-of-stdioh-functions">General Naming Conventions of <code>stdio.h</code> Functions</h2>
				<p>As you can see by the <code>printf</code> vs <code>fprintf</code> example, above, a lot of the
					standard library functions will do similar things but with slightly different
					arguments.
					We're going to go through most of them.
				</p>
				<h3 id="the-four-base-functions">The Four Base Functions</h3>
				<p>In <code>C</code>, we have four base operations for I/O:
				</p>
				<ul>
					<li><b><code>put</code></b>, which prints out its argument,
					</li>
					<li><b><code>get</code></b>, which takes in its argument and stores it in a variable,
					</li>
					<li><b><code>printf</code></b>, which prints out its arguments as dictated by a format string,
					</li>
					<li>and <b><code>scanf</code></b>, which takes in input and stores it in a variable as dictated
						by a format string.
					</li>
				</ul>
				<h3 id="the-source-and-destination-prefixes">The Source and Destination Prefixes</h3>
				<p>By default, the four base functions interact with the terminal.
					To change the source for <code>get</code> and <code>scanf</code> and to change the destination for
					<code>put</code> and <code>printf</code>, we add a letter or two to the front of the name.
				</p>
				<ul>
					<li><b><code>f</code></b> added to the front of any of the base functions changes the input
						source or output destination to a <code>FILE *</code>, which is generally specified as the
						first argument.
					</li>
					<li><b><code>s</code></b> will change the input source to a <code>const char *</code> and the output
						destination to a <code>char *</code>, which is generally specified as the first argument.
					</li>
					<li><b><code>sn</code></b> is the same as <code>s</code>, except it has another argument specifying the
						number of characters it can read.
						<code>sn</code> only applies to later versions of <code>C</code> and it only applies to <code>printf</code>.
					</li>
				</ul>
				<p>Note that <code>sget</code> would essentially just copy data that's already in your
					program, so there are no <code>sget</code> functions.
					I'm also skipping the <code>v</code> prefix since it's a more advanced feature that I have
					never used.
				</p>
				<p>We're done with the two format string functions, <code>printf</code> and <code>scanf</code>, so let's
					show you the syntax for all the derived functions:
				</p>
<div class="code-block"><pre><span></span><span class="c1">// Write to file</span>
<span class="kt">int</span> <span class="nf">fprintf</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="n">stream</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Read from file</span>
<span class="kt">int</span> <span class="nf">fscanf</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="n">stream</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Print to terminal</span>
<span class="kt">int</span> <span class="nf">printf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Read from terminal</span>
<span class="kt">int</span> <span class="nf">scanf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Write to an array of characters</span>
<span class="kt">int</span> <span class="nf">snprintf</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span> <span class="n">string</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">n</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>
<span class="kt">int</span> <span class="nf">sprintf</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span> <span class="n">string</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Read from an array of characters</span>
<span class="kt">int</span> <span class="nf">sscanf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">string</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">format</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
				
				<h3 id="format-suffixes">Format Suffixes</h3>
				<p>Since <code>get</code> and <code>put</code> don't have a format specifier but we would like to print
					different things and we've already added stuff to the beginning of the word for
					the input, we need to create new functions with stuff added to the end of the
					name.
				</p>
				<ul>
					<li><b><code>s</code></b> will tell the computer to expect a string as the input or output.
					</li>
					<li><b><code>c</code></b> will read a character from or write a character to a <code>FILE *</code>.
					</li>
					<li><b><code>char</code></b> will read a character from or write a character to <code>stdin</code>, a.k.a.
						the terminal.
					</li>
				</ul>
				<p>As a quick disclaimer, I don't use the <code>get</code> and <code>put</code> functions that often
					since I can do everything with format strings and I don't need to remember as
					much.
					I won't go into the syntax here, but you can find the syntax for these functions
					on <a href="http://www.cplusplus.com/reference/cstdio/">the c++ website</a>
					(<code>C++</code> contains all the standard library files of <code>C</code> and some more for its
					standard library, so there isn't as much of a reason to make another website.).
				</p>
				<div class="aside" style="border-width: 8px; border-radius: 12px;">
					<h4 style="color: red; text-align: center;">WARNING</h4><hr>
					<p>If you remember back in the article on <a href="../memory-addresses/">Memory
						Addresses in C</a>, I had a warning about how <b>by allowing you to directly
						interact with memory, <code>C</code> introduces several security vulnerabilities that
						mainly consist of accessing memory outside of a buffer</b>.
					</p>
					<p>I ended the warning with:
					</p>
					<blockquote>
					<p>As of right now, we neither have the capability to allow or prevent a malicious
						user from accessing memory outside of a buffer, so we'll save that for a later
						article.
					</p>
					</blockquote>
					<p>Now, we have ways for users to change how our program behaves, so we need to
						prevent mailicious users from accessing memory outside of a buffer, which we can
						do with format string functions, <code>fgets</code>, etc. since we can specify the maximum
						number of characters we want to read.
						We can't, however, prevent malicious users from exploiting <code>gets</code>, which reads
						input from <code>stdio</code>.
						<code>gets</code>, however, doesn't specify the number of characters the user can input,
						meaning that a malicious user could use it to exploit our code and do something
						like <a
						href="https://www.washingtonpost.com/news/the-switch/wp/2013/11/01/how-a-grad-student-trying-to-build-the-first-botnet-brought-the-internet-to-its-knees/">launch
						a Denial of Service campaign that shut down the internet for a few days</a>.
						The "Morris Worm", named after Robert Morris, was a white hat hacking attempt
						intended to highlight several security vulnerabilities in commonly used
						programs, including a buffer overflow based on <code>gets</code>.
					</p>
					<p>For this reason, <code>gets</code> was deprecated before the first official <code>C</code> standard
						was released and removed entirely from the <code>C</code> standard library in a later
						release.
						Even then, if you somehow get a working program, your compiler will actually
						contain another warning saying that <code>gets</code> is dangerous and should not be used.
					</p>
				</div>
				<h2 id="reading-from-vs-writing-to-a-stream">Reading From vs Writing to a Stream</h2>
				<p>Reading from streams is similar to writing from streams except that it's
					generally easier to write to a stream than read from a stream.
					For example, let's say that you want the program to print out the ID number of
					the student when they log in.
					In that case, assuming that the student ID is a base 10 number (has the digits
					zero to nine) and the value is stored in an <code>unsigned int</code>, then you can print
					it out using
				</p>
<div class="code-block"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Student ID: %u</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">student_id</span><span class="p">);</span>
</pre></div>
				
				<p>Pretty straightforward, right?
					Likewise, if you want to print to a file, you can use <code>fprintf</code> and specify the
					stream as the first argument.
					On the other hand, let's say that you want to read a student ID number from a
					file.
					In that case, you could use
				</p>
<div class="code-block"><pre><span></span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;Enter your student ID: %u&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">student_id</span><span class="p">);</span>
</pre></div>
				
				<p>right?
				</p>
				<p>If we were to use that format string, a user with ID number 1234567 would have
					to type "Enter your student ID: 1234567", not just "1234567".
					If you type anything else, <code>scanf</code> will just return <code>0</code> since it could fill zero
					arguments.
					Instead, you should use something like
				</p>
<div class="code-block"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Enter your student ID: &quot;</span><span class="p">);</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%u&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">student_id</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Enter your student ID: &quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
				
				<p>Except that won't actually work because you need to use <code>scanf</code> again to clean
					up <code>stdin</code> because <code>scanf</code> won't remove anything it can't convert, so whatever
					you type in will still be in <code>stdin</code> waiting to be read.
					Your computer will essentially go through this process:
				</p>
				<ol>
					<li>Standard input is empty, so I'm going to let the user type in input.
					</li>
					<li>Standard input now has input, so I'm going to read the input.
					</li>
					<li>Can I convert the input to an unsigned integer?
					</li>
					<li>No, so I'm not going to remove it from standard input.
					</li>
					<li>Print out <code>"Enter your student ID: "</code>.
					</li>
					<li>Go back to the top of the <code>while</code> loop
					</li>
					<li>Standard input is <b>NOT</b> empty, so I'm going to read the input.
					</li>
					<li>Can I convert the input to an unsigned integer?
					</li>
					<li>No, so I'm not going to remove it from standard input.
					</li>
				</ol>
				<p>The correct way to do it is to clear out standard input if the input is invalid.
				</p>
<div class="code-block"><pre><span></span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Enter your student ID: &quot;</span><span class="p">);</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%u&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">student_id</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%*[^</span><span class="se">\n</span><span class="s">]&quot;</span><span class="p">);</span>       <span class="c1">// Remove anything in stdin that isn&#39;t a newline.</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Enter your student ID: &quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
				
				<p>In short, <b><code>scanf</code> can only read characters in the exact format you give
					it</b>.
					I tried to write the word counter with <code>scanf</code>, and it didn't really work, so
					we're going to write our own simple parsing function.
					Later, we're going to try to incorporate an external library that will take care
					of most of this functionality for us.
					If you want <a
					href="http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html">an in
					depth criticism of the <code>scanf</code> functions</a>, read the linked article.
				</p>
				<h2 id="summary">Summary</h2>
				<p>Now, we've introduced the most common I/O functions and their uses.
					To recap, I'm going to describe them and their use cases.
				</p>
				<ul>
					<li>Use <code>printf</code> when you want to print something out from the terminal.
					</li>
					<li>Use <code>fprintf</code> when you want to print something to a file.
					</li>
					<li>Use <code>fgets</code> when you want to read from a file or get user input.
					</li>
					<li>Use <code>puts</code> and <code>fputs</code> when you want to print a plain string (i.e. no format
						strings or anything).
						Treat them like shorthand for <code>printf("%s\n", string)</code> and <code>fprintf<code>"%s",
						string)</code>.
					</li>
				</ul>
				<p>These are the main functions that you will use for file I/O or terminal
					interaction.
					While you can certainly use other functions (besides <code>gets</code> because it's an
					abomination), I mainly use these functions in the order shown above.
				</p>
				<h2 id="whats-next">What's Next</h2>
				<p>After this article, we now have all the tools we need to write the first of our
					goal programs: the <a href="../word-counter/index.html">word counter</a>.
				</p>
			</div>
			<div class="article">
				<div id="author-description-local">
					<img src="https://tuacm.com/authors/joseph-mellor/large.jpg" id="author-description-image" alt="A picture of Joseph Mellor, the author.">
					<div id="author-description-text">
						<p>Joseph Mellor is a Junior at TU majoring in Physics, Computer Science, and
							Math.
							He is also the chief editor of the website and the author of the tumd markdown
							compiler.
							If you want to see more of his work, check out his <a
							href="https://github.com/TheLandfill">github repository</a>.
							<br>
							Credit to Allison Pennybaker for the picture.
						</p>
					</div>
				</div>
			</div>
			<nav id="sidenav">
				<a href="#files-in-c-pt-2" style="padding-left:12px;">Files in C, Pt. 2</a>
				<a href="#io-without-format-strings" style="padding-left:24px;">I/O Without Format Strings</a>
				<a href="#fgets-and-fputs" style="padding-left:36px;"><code>fgets</code> and <code>fputs</code></a>
				<a href="#the-terminal-as-a-file" style="padding-left:36px;">The Terminal as a File</a>
				<a href="#io-with-format-strings" style="padding-left:24px;">I/O With Format Strings</a>
				<a href="#escape-sequences-in-format-strings" style="padding-left:36px;">Escape Sequences in Format Strings</a>
				<a href="#printf-and-fprintf" style="padding-left:36px;"><code>printf</code> and <code>fprintf</code></a>
				<a href="#general-naming-conventions-of-stdioh-functions" style="padding-left:24px;">General Naming Conventions of <code>stdio.h</code> Functions</a>
				<a href="#the-four-base-functions" style="padding-left:36px;">The Four Base Functions</a>
				<a href="#the-source-and-destination-prefixes" style="padding-left:36px;">The Source and Destination Prefixes</a>
				<a href="#format-suffixes" style="padding-left:36px;">Format Suffixes</a>
				<a href="#reading-from-vs-writing-to-a-stream" style="padding-left:24px;">Reading From vs Writing to a Stream</a>
				<a href="#summary" style="padding-left:24px;">Summary</a>
				<a href="#whats-next" style="padding-left:24px;">What's Next</a>
			</nav>
			<div id="sidenav-activator"></div>
		</div>
		<div id="footer" class="mt-5 py-5 text-center px-4">
			<div id="footer-links">
				<a href="#">Blog</a>
				<a href="#">Get Involved</a>
				<a href="http://hacktulsa.com">Hackathon</a>
				<a href="#">GitHub</a>
			</div>
		</div>
		<script src="https://tuacm.com/js/sidenav.js"></script>
	</body>
</html>
