TUMD_FILES = $(shell find . -type f -name 'index.tumd')
HTML_FILES = $(patsubst %.tumd, %.html, $(TUMD_FILES))
META_FILES = $(patsubst %/index.tumd, %/meta-description.txt, $(TUMD_FILES))
ROOT = ${CURDIR}
MD = /home/joseph/dev/mdxx/tumd/

.PHONY: all
all: $(HTML_FILES)

blog/index.html: blog/index.tumd blog/meta-description.txt blog/tagged.txt
	@echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';
	(cd $(MD);./markdown.py "$(ROOT)/$<")

%/index.html: %/index.tumd %/meta-description.txt
	@echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';
	(cd $(MD);./markdown.py "$(ROOT)/$<")

%/meta-description.txt:
	touch $@

.PHONY: clean
clean:
	rm $(HTML_FILES)

.PHONY: listall

listall:
	@echo -e "$(TUMD_FILES)"
	@echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';
	@echo -e "$(HTML_FILES)"
	@echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';
	@echo -e "$(DATE_FILES)"
	@echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';
	@echo -e "$(META_FILES)"
	@echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';echo -e '\e[38;5;51m\e[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\e[0m';
