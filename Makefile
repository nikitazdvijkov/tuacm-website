TUMD_FILES = $(shell find blog/ -mindepth 2 -type f -name 'index.tumd')
DATE_FILES := $(patsubst %/index.tumd, %/date.txt, $(TUMD_FILES))
TUMD_FILES = $(shell find . -type f -name 'index.tumd')
HTML_FILES = $(patsubst %.tumd, %.html, $(TUMD_FILES))
META_FILES = $(patsubst %/index.tumd, %/meta-description.txt, $(TUMD_FILES))
ROOT = ${CURDIR}
MD = /home/joseph/dev/tuacm-articles/tumd/

.PHONY: all
all: $(HTML_FILES)

%/index.html: %/index.tumd %/meta-description.txt
	@echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';
	(cd $(MD);./markdown.py "$(ROOT)/$<")

meta-description.txt:
	touch $@

.PHONY: clean
clean:
	rm $(HTML_FILES) $(DATE_FILES)

.PHONY: listall

listall:
	@echo "$(TUMD_FILES)"
	@echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';
	@echo "$(HTML_FILES)"
	@echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';
	@echo "$(DATE_FILES)"
	@echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';
	@echo "$(META_FILES)"
	@echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';echo '\033[38;5;51m\033[48;5;15m-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\033[0m';
